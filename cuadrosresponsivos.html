<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Renderizador Figuras PowerPoint (Responsivo)</title>
<style>
  :root {
    --base-width: 1280;
    --base-height: 720;
  }

  body {
    background: #e6e6e6;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
  }

  .canvas-wrapper {
    position: relative;
    width: 90vw;                  /* Escala según el ancho de la ventana */
    max-width: 1280px;
    aspect-ratio: 16 / 9;         /* Mantiene proporción 1280x720 */
    background: #f9f9f9;
    border: 2px solid #ccc;
    box-shadow: 0 0 10px rgba(0,0,0,0.15);
    overflow: hidden;
  }

  .canvas {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-origin: top left;
  }

  .figura {
    position: absolute;
    box-sizing: border-box;
    transform-origin: top left;
  }
</style>
</head>
<body>
  <div class="canvas-wrapper">
    <div class="canvas" id="canvas"></div>
  </div>

<script>
async function cargarFiguras() {
  const res = await fetch('Figuras_PowerPoint.json');
  const json = await res.json();
  const figuras = json.figuras;
  const canvas = document.getElementById('canvas');

  // Crear las figuras
  figuras.forEach(fig => {
    const tipo = fig.tipo.toLowerCase();
    const el = document.createElement('div');
    el.classList.add('figura');

    const relleno = fig.colorHex || 'transparent';
    const borde = fig.bordeHex || 'transparent';
    const ancho = fig.ancho_px;
    const alto = fig.alto_px;
    const x = fig.posX_px;
    const y = fig.posY_px;
    const rot = fig.rotacion || 0;

    // Guardar datos originales para escalar después
    el.dataset.ancho = ancho;
    el.dataset.alto = alto;
    el.dataset.x = x;
    el.dataset.y = y;
    el.dataset.rot = rot;
    el.dataset.relleno = relleno;
    el.dataset.borde = borde;
    el.dataset.tipo = tipo;

    canvas.appendChild(el);
  });

  // Dibujar con escala inicial
  aplicarEstilosEscalados();
}

// Función para aplicar el escalado según el tamaño real del contenedor
function aplicarEstilosEscalados() {
  const canvas = document.getElementById('canvas');
  const wrapper = canvas.parentElement;
  const escalaX = wrapper.clientWidth / 1280;
  const escalaY = wrapper.clientHeight / 720;
  const escala = Math.min(escalaX, escalaY);

  Array.from(canvas.children).forEach(el => {
    const tipo = el.dataset.tipo;
    const ancho = parseFloat(el.dataset.ancho) * escala;
    const alto = parseFloat(el.dataset.alto) * escala;
    const x = parseFloat(el.dataset.x) * escala;
    const y = parseFloat(el.dataset.y) * escala;
    const rot = parseFloat(el.dataset.rot);
    const relleno = el.dataset.relleno;
    const borde = el.dataset.borde;

    // Resetear estilos
    el.style = `
      position:absolute;
      left:${x}px;
      top:${y}px;
      transform:rotate(${rot}deg);
      transform-origin:top left;
      box-sizing:border-box;
    `;

    if (tipo.startsWith("rect")) {
      el.style.width = `${ancho}px`;
      el.style.height = `${alto}px`;
      el.style.background = relleno;
      el.style.border = `2px solid ${borde}`;
    } 
    else if (tipo.includes("círc") || tipo.includes("oval")) {
      el.style.width = `${ancho}px`;
      el.style.height = `${alto}px`;
      el.style.background = relleno;
      el.style.border = `2px solid ${borde}`;
      el.style.borderRadius = "50%";
    } 
    else if (tipo.includes("triáng")) {
      el.style.width = `0px`;
      el.style.height = `0px`;
      el.style.borderLeft = `${(ancho / 2)}px solid transparent`;
      el.style.borderRight = `${(ancho / 2)}px solid transparent`;
      el.style.borderBottom = `${alto}px solid ${relleno}`;
      el.style.background = "transparent";
    } 
    else if (tipo.includes("imagen")) {
      el.style.width = `${ancho}px`;
      el.style.height = `${alto}px`;
      el.style.backgroundImage = "url('https://via.placeholder.com/150')";
      el.style.backgroundSize = "cover";
      el.style.border = `2px solid ${borde}`;
    }
  });
}

// Reescalar al cambiar el tamaño de la ventana
window.addEventListener('resize', aplicarEstilosEscalados);

// Iniciar carga
cargarFiguras();
</script>
</body>
</html>
